<!DOCTYPE html>
<html lang="zh-CN">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Fitness Tracker - 首页</title>
	<link rel="stylesheet" href="css/style.css">
	<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
</head>
<body>
	<header class="site-header">
		<h1>Fitness Tracker</h1>
		<nav class="site-nav">
			<a href="dashboard.html">仪表盘</a>
			<a href="nutrition.html">营养记录</a>
		</nav>
	</header>

	<main class="container">
		<section class="card">
			<div style="display:flex; gap:8px; margin-bottom:12px;">
				<button id="tabLogin" class="btn" style="background:transparent; border:1px solid var(--border); color:var(--text);">登录</button>
				<button id="tabRegister" class="btn" style="background:transparent; border:1px solid var(--border); color:var(--text);">注册</button>
			</div>

			<div id="panelLogin">
				<h2>登录</h2>
				<form id="loginForm" class="form">
					<label for="email">邮箱</label>
					<input type="email" id="email" name="email" placeholder="you@example.com" required>
					<label for="password">密码</label>
					<input type="password" id="password" name="password" placeholder="••••••••" required>
					<div style="display:flex; gap:8px; flex-wrap:wrap;">
						<button type="submit" class="btn">登录</button>
					</div>
				</form>
			</div>

			<div id="panelRegister" style="display:none;">
				<h2>注册</h2>
				<form id="registerForm" class="form">
					<label for="regName">姓名</label>
					<input type="text" id="regName" name="regName" placeholder="你的姓名" required>
					<label for="regEmail">邮箱</label>
					<input type="email" id="regEmail" name="regEmail" placeholder="you@example.com" required>
					<label for="regPassword">密码</label>
					<input type="password" id="regPassword" name="regPassword" placeholder="至少 6 位" required>
					<div style="display:flex; gap:8px; flex-wrap:wrap;">
						<button type="submit" class="btn">注册</button>
					</div>
				</form>
				<p class="muted">注册成功后可能需要前往邮箱验证。</p>
			</div>
			<p class="muted">提示：认证由 Supabase 提供；本地训练与营养数据存储在浏览器本地。</p>
		</section>

		<section class="grid">
			<a class="card link-card" href="dashboard.html">
				<h3>前往仪表盘 →</h3>
				<p>查看今日训练、统计和历史记录。</p>
			</a>
			<a class="card link-card" href="nutrition.html">
				<h3>记录营养摄入 →</h3>
				<p>快速添加餐食并查看总卡路里。</p>
			</a>
		</section>
	</main>

	<footer class="site-footer">
		<p>© <span id="year"></span> Fitness Tracker</p>
	</footer>

	<script src="js/auth.js"></script>
	<script>
		document.getElementById('year').textContent = new Date().getFullYear();
		// 标签切换
		const tabLogin = document.getElementById('tabLogin');
		const tabRegister = document.getElementById('tabRegister');
		const panelLogin = document.getElementById('panelLogin');
		const panelRegister = document.getElementById('panelRegister');
		function showLogin() {
			panelLogin.style.display = '';
			panelRegister.style.display = 'none';
		}
		function showRegister() {
			panelLogin.style.display = 'none';
			panelRegister.style.display = '';
		}
		tabLogin.addEventListener('click', showLogin);
		tabRegister.addEventListener('click', showRegister);
		showLogin();

		document.getElementById('loginForm').addEventListener('submit', async function (e) {
			e.preventDefault();
			const email = document.getElementById('email').value.trim();
			const password = document.getElementById('password').value;
			const res = await window.FTAuth.signIn(email, password);
			if (res) window.location.href = 'dashboard.html';
		});
		document.getElementById('registerForm').addEventListener('submit', async function (e) {
			e.preventDefault();
			const name = document.getElementById('regName').value.trim();
			const email = document.getElementById('regEmail').value.trim();
			const password = document.getElementById('regPassword').value;
			const res = await window.FTAuth.signUp(email, password);
			if (res) {
				alert('注册成功，请按需前往邮箱验证后再登录。');
				showLogin();
				document.getElementById('email').value = email;
			}
		});
	</script>
</body>
</html>


